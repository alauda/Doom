# 开始 \{#start}

## 创建项目 \{#create}

首先，你可以通过以下命令创建一个新目录：

```bash
mkdir my-docs && cd my-docs
```

执行 `npm init -y` 来初始化一个项目。你可以使用 npm、yarn 或 pnpm 安装 doom:

<PackageManagerTabs command="install -D @alauda/doom typescript" />

然后通过如下命令创建文件:

```bash
# 创建 docs 目录，默认支持中英文双语
mkdir docs/en && echo '# Hello World' > docs/en/index.md
mkdir docs/zh && echo '# 你好世界' > docs/zh/index.md
```

在 `package.json` 中加上如下的脚本:

```json
{
  "scripts": {
    "dev": "doom dev",
    "build": "doom build",
    "new": "doom new",
    "serve": "doom serve",
    "translate": "doom translate",
    "export": "doom export"
  }
}
```

然后初始化一个配置文件 `doom.config.yml`:

```yaml
title: My Docs
```

同时新建 `tsconfig.json`，内容如下：

```jsonc
{
  "compilerOptions": {
    "jsx": "react-jsx",
    "module": "NodeNext",
    "moduleResolution": "NodeNext",
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "resolveJsonModule": true,
    "skipLibCheck": true,
    "strict": true,
    "target": "ESNext",
  },
  "mdx": {
    "checkMdx": true,
  },
}
```

最后创建 `global.d.ts` 文件，内容如下：

```ts
/// <reference types="@alauda/doom/runtime" />
```

这样你便可以在 `.mdx` 文件中类型安全地使用 doom 提供的全局组件了。

## 命令行工具 \{#cli}

```bash
doom -h

# output
Usage: doom [options] [command]

Doctor Doom making docs.

Options:
  -V, --version                   output the version number
  -c, --config <config>           Specify the path to the config file
  -v <version>                    Specify the version of the documentation
  -b, --base <base>               Override the base of the documentation
  -p, --prefix <prefix>           Specify the prefix of the documentation base
  -f, --force [boolean]           Force to fetch latest reference remotes or scaffolding templates, otherwise use local cache (default: false)
  -i, --ignore [boolean]          Ignore internal routes (default: false)
  -h, --help                      display help for command

Commands:
  dev [options] [root]            Start the development server
  build [root]                    Build the documentation
  preview|serve [options] [root]  Preview the built documentation
  new [template]                  Generate scaffolding from templates
  translate [root]                Translate the documentation
  export [options] [root]         Export the documentation as PDF
  help [command]                  display help for command
```

### 启动开发服务 \{#dev}

执行 `yarn dev` 启动开发服务，浏览器会自动打开文档首页

### 生产环境构建 \{#build}

执行 `yarn build` 构建生产环境代码，构建完成后会在 `dist` 目录生成静态文件

### 本地预览 \{#serve}

执行 `yarn serve` 预览构建后的静态文件，注意如果使用了 `-b`, `-p` 参数构建，预览时也需要使用 `-b`, `-p` 参数

### 使用脚手架模板 \{#new}

执行 `yarn new` 使用脚手架模板生成项目、模块或文档

### 翻译文档 \{#translate}

```bash
doom translate -h

# output
Usage: doom translate [options] [root]

Translate the documentation

Arguments:
  root                     Root directory of the documentation

Options:
  -s, --source <language>  Document source language (default: "zh")
  -t, --target <language>  Document target language (default: "en")
  -h, --help               display help for command
```

执行 `yarn translate` 将 `<root>/<source>` 源语言文档自动翻译到 `<root>/<target>` 目标语言文档

:::warning
目前需要在本地配置 `AZURE_OPENAI_API_KEY` 环境变量，请联系 IDP 文档团队获取
:::

文档中可以使用元数据控制翻译行为

```yaml
---
i18n:
  title:
    en: DevOps Connectors
  additionalPrompts: '此文中的 Connectors 是专有名词，不要翻译'
  disableAutoTranslation: false
title: DevOps 连接器
---
```

### 导出 PDF \{#export}

:::warning
请在执行导出操作前先执行 `yarn build` 构建操作
:::

执行 `yarn export` 导出文档为 PDF 文件，注意如果使用了 `-b`, `-p` 参数构建，导出时也需要使用 `-b`, `-p` 参数

导出功能依赖 [`playwright`](https://playwright.dev)，流水线请使用 `build-harbor.alauda.cn/frontend/playwright-runner:doom` 作为依赖安装和文档构建的基础镜像，
本地可以设置如下环境变量加速下载：

```dotenv title=".env.yarn"
PLAYWRIGHT_DOWNLOAD_HOST="https://cdn.npmmirror.com/binaries/playwright"
```
