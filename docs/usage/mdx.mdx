---
description: 使用 MDX 可以实现动态内容的展示和内容复用
weight: 3
---

# MDX

[MDX](https://mdxjs.com/) 是一种 Markdown 的扩展语法，允许在 Markdown 中使用 JSX 语法，使用方式可以参考 [rspress MDX](https://rspress.dev/zh/guide/basic/use-mdx)。

## rspress 组件

`rspress` 主题提供的[内置组件](https://rspress.dev/zh/guide/default-theme/components)大部分已调整为全局组件，可以在 `.mdx` 文件中无需导入直接使用，包括：

- `Badge`
- `Card`
- `LinkCard`
- `PackageManagerTabs`
- `Steps`
- `Tab/Tabs`
- `Toc`

其他不常用的组件可以通过 `@rspress/core/theme` 导入使用，例如：

```mdx title="preview.mdx"
import { SourceCode } from '@rspress/core/theme'

<SourceCode href="/" />
```

## doom 组件

`doom` 提供了一些全局组件来辅助文档编写，不需要导入即可直接使用，目前包括：

### `Overview`

文档概览组件，用于展示文档目录

### `QuickNav`

快速导航组件，用于展示快速导航信息，样式和功能将根据后续实际使用需求进行调整

```mdx title="quick-nav.mdx"
<QuickNav
  items={[
    {
      icon: '/logo.svg',
      title: 'Doom',
      links: [
        {
          title: '首页',
          href: '/',
        },
        {
          title: '开始',
          href: '/start',
        },
        {
          title: '使用',
          href: '/usage/',
        },
      ],
    },
  ]}
/>
```

<QuickNav
  items={[
    {
      icon: '/logo.svg',
      title: 'Doom',
      links: [
        {
          title: '首页',
          href: '/',
        },
        {
          title: '开始',
          href: '/start',
        },
        {
          title: '使用',
          href: '/usage/',
        },
      ],
    },
  ]}
/>

### `Callouts`

源码标注组件

::: note

1. 请根据实际语言使用行内代码注释，如 `;`, `%`, `#`, `//`, `/** */`, `--` 和 `<!-- -->` 等
2. 如果需要将其视为代码注释，请使用 `[\!code callout]` 进行转义

:::

````mdx
```sh
Memory overhead per virtual machine ≈ (1.002 × requested memory) \
              + 218 MiB \  # [\!code callout]
              + 8 MiB × (number of vCPUs) \  # [\!code callout]
              + 16 MiB × (number of graphics devices) \  # [\!code callout]
              + (additional memory overhead)  # [\!code callout]
```

<Callouts>

1. Required for the processes that run in the `virt-launcher` pod.
2. Number of virtual CPUs requested by the virtual machine.
3. Number of virtual graphics cards requested by the virtual machine.
4. Additional memory overhead:
   - If your environment includes a Single Root I/O Virtualization (SR-IOV) network device or a Graphics Processing Unit (GPU), allocate 1 GiB additional memory overhead for each device.
   - If Secure Encrypted Virtualization (SEV) is enabled, add 256 MiB.
   - If Trusted Platform Module (TPM) is enabled, add 53 MiB.

</Callouts>
````

```sh
Memory overhead per virtual machine ≈ (1.002 × requested memory) \
              + 218 MiB \  # [!code callout]
              + 8 MiB × (number of vCPUs) \  # [!code callout]
              + 16 MiB × (number of graphics devices) \  # [!code callout]
              + (additional memory overhead)  # [!code callout]
```

<Callouts>

1. Required for the processes that run in the `virt-launcher` pod.
2. Number of virtual CPUs requested by the virtual machine.
3. Number of virtual graphics cards requested by the virtual machine.
4. Additional memory overhead:
   - If your environment includes a Single Root I/O Virtualization (SR-IOV) network device or a Graphics Processing Unit (GPU), allocate 1 GiB additional memory overhead for each device.
   - If Secure Encrypted Virtualization (SEV) is enabled, add 256 MiB.
   - If Trusted Platform Module (TPM) is enabled, add 53 MiB.

</Callouts>

更多源码转换功能请参考 [Shiki Transformers](https://shiki.style/packages/transformers#transformers)。

### `Directive`

有时，由于嵌套缩进，[自定义容器](https://rspress.dev/zh/guide/basic/use-mdx#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%B9%E5%99%A8)语法可能失效，可以使用 `Directive` 组件代替

```mdx
- 多语言文档(`doc/en`)的目录结构需要与 `doc/zh` 目录下的文档完全一致，保证多语言文档的链接除了语言标识外完全相同。

  <Directive type="danger" title="注意">
    如果是使用自动化翻译工具进行翻译，则无需关心该问题，自动化翻译工具会自动根据
    `doc/zh` 生成目标语言文档的目录结构。
  </Directive>
```

- 多语言文档(`doc/en`)的目录结构需要与 `doc/zh` 目录下的文档完全一致，保证多语言文档的链接除了语言标识外完全相同。

  <Directive type="danger" title="注意">
    如果是使用自动化翻译工具进行翻译，则无需关心该问题，自动化翻译工具会自动根据
    `doc/zh` 生成目标语言文档的目录结构。
  </Directive>

### `ExternalSite`

引用外部站点组件

```mdx
<ExternalSite name="connectors" />
```

<ExternalSite name="connectors" />

### `ExternalSiteLink`

引用外部站点链接组件

```mdx
<ExternalSiteLink name="connectors" href="link" children="Content" />
```

<ExternalSiteLink name="connectors" href="link" children="Content" />

:::tip

在 mdx 中 `<ExternalSiteLink name="connectors" href="link" children="Content" />` 与下面的内容含义不同

```mdx
<ExternalSiteLink name="connectors" href="link">
  Content {/* 将渲染在 `p` 元素内 */}
</ExternalSiteLink>
```

如果不希望文本渲染在 `p` 元素内，可以像上面的示例一样使用 `children` 属性传递

:::

### `JsonViewer`

```mdx
<JsonViewer value={{ key: 'value' }} />
```

<JsonViewer value={{ key: 'value' }} />

## 自定义组件复用

根据[约定](./convention)，我们可以将需要复用的内容抽取到 `shared` 目录中，然后在需要的地方引入即可，比如：

```mdx
import CommonContent from './shared/CommonContent.mdx'

<CommonContent />
```

如果需要使用更多 [runtime](https://rspress.dev/zh/api/client-api/api-runtime) 相关的 API，可以使用 `.jsx/.tsx` 实现组件，然后在 `.mdx` 文件中引入使用。

```tsx
// shared/CommonContent.tsx
export const CommonContent = () => {
  const { page } = usePageData()
  return <div>{page.title}</div>
}

// showcase/content.mdx
import { CommonContent } from './shared/CommonContent'
;<CommonContent />
```

:::warning
注意：目前 `.mdx` 导出的组件不支持 `props` 传参，参考[此 issue](https://github.com/web-infra-dev/rspress/issues/1555)，因此需要传递 `props` 的场景请使用 `.jsx/.tsx` 组件进行开发
:::
